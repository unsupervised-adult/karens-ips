# ML Detector Domain Blocking Rules
# Uses Suricata datasets for efficient matching against 345K+ domains

# DNS Query Blocking
drop dns any any -> any any (msg:"ML Detector: Blocked DNS Query"; \
    dns.query; dataset:isset,blocked-domains, type string, load ../datasets/blocked-domains.lst; \
    classtype:policy-violation; sid:9000001; rev:1;)

# HTTP Host Blocking
drop http any any -> any any (msg:"ML Detector: Blocked HTTP Host"; \
    flow:established,to_server; http.host; \
    dataset:isset,blocked-domains, type string, load ../datasets/blocked-domains.lst; \
    classtype:policy-violation; sid:9000002; rev:1;)

# TLS SNI Blocking
drop tls any any -> any any (msg:"ML Detector: Blocked TLS SNI"; \
    tls.sni; dataset:isset,blocked-domains, type string, load ../datasets/blocked-domains.lst; \
    classtype:policy-violation; sid:9000003; rev:1;)
