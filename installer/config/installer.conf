# Karen's IPS Installer Configuration
# SPDX-FileCopyrightText: 2025 Karen's IPS
# SPDX-License-Identifier: GPL-2.0-only

# =============================================================================
# NETWORK CONFIGURATION
# =============================================================================
#
# IMPORTANT: Configure these settings for your environment
#
# To find your interfaces, run:
#   ip link show
#   ip addr show
#
# Typical interface names:
#   - Legacy:  eth0, eth1, eth2
#   - systemd: enp0s3, enp6s18, ens33
#   - Cloud:   ens4, ens5
#   - Virtual: ens160, ens192

# Management Interface (SSH access, updates)
# Leave empty for auto-detection of first interface with IP
MGMT_IFACE=""                     # e.g., "eth0", "enp0s3", "ens33"
MGMT_IP="dhcp"                    # Or specific IP like "192.168.1.10/24"
MGMT_GW=""                        # Gateway (if static IP)
MGMT_DNS="8.8.8.8"                # DNS server (default: Google DNS)

# Bridge Interfaces (traffic inspection)
# These should be two separate interfaces for inline IPS mode
# Leave empty for interactive selection during install
IFACE_IN=""                       # Bridge input interface  (e.g., "eth1", "enp6s19")
IFACE_OUT=""                      # Bridge output interface (e.g., "eth2", "enp6s20")

# Network Definition
# Your protected network CIDR - will auto-detect if left empty
HOME_NET=""                       # e.g., "192.168.1.0/24", "10.0.0.0/8"

# =============================================================================
# SYSTEM CONFIGURATION
# =============================================================================

# Timezone
TIMEZONE="UTC"

# System Requirements
MIN_MEMORY_MB=2048                # Minimum RAM in MB
MIN_CPU_CORES=2                   # Minimum CPU cores

# =============================================================================
# SURICATA CONFIGURATION
# =============================================================================

# Suricata Version
SURICATA_VERSION="8.0"

# Suricata Performance
SURICATA_AF_PACKET_THREADS=4      # AF_PACKET threads
SURICATA_WORKERS=4                # Worker threads

# NFQUEUE Configuration
NFQUEUE_ID=0                      # NFQUEUE queue ID
NFQUEUE_SIZE=4096                 # Queue size

# Rule Sources
SURICATA_ENABLE_ET_OPEN=true      # Emerging Threats Open
SURICATA_ENABLE_ET_PRO=false      # Emerging Threats Pro (requires license)

# =============================================================================
# SLIPS CONFIGURATION
# =============================================================================

# SLIPS Branch
SLIPS_BRANCH="develop"            # Git branch to use

# SLIPS Web UI
SLIPS_WEBUI_PORT=55000            # Web interface port

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis Database IDs
REDIS_DB_SLIPS=1                  # SLIPS database
REDIS_DB_ML_DETECTOR=2            # ML Detector database

# Redis Performance
REDIS_MAX_MEMORY="2gb"            # Maximum memory
REDIS_MAX_MEMORY_POLICY="allkeys-lru"

# =============================================================================
# BLOCKLIST CONFIGURATION
# =============================================================================

# Blocklist Repositories
BLOCKLISTS_DIR="/opt/karens-ips-blocklists"

# Individual Blocklist Selection
# Set to "true" to enable, "false" to disable
# Leave empty for interactive selection during install

# Perflyst PiHole Blocklists (SmartTV tracking, Android, FireTV, SessionReplay)
BLOCKLIST_PERFLYST_SMARTTV=""     # SmartTV telemetry/tracking (Samsung, LG, etc)
BLOCKLIST_PERFLYST_ANDROID=""     # Android tracking domains
BLOCKLIST_PERFLYST_FIRETV=""      # Amazon FireTV tracking
BLOCKLIST_PERFLYST_SESSIONREPLAY=""  # SessionReplay tracking scripts

# hagezi DNS Blocklists (comprehensive ad/tracker blocking)
# Choose ONE version based on your blocking preference:
BLOCKLIST_HAGEZI_LIGHT=""         # ðŸ“— Light (low blocking, minimal false positives)
BLOCKLIST_HAGEZI_NORMAL=""        # ðŸ“˜ Normal (medium blocking, relaxed/balanced)
BLOCKLIST_HAGEZI_PRO=""           # ðŸ“’ Pro (balanced - RECOMMENDED)
BLOCKLIST_HAGEZI_PROPLUS=""       # ðŸ“™ Pro++ (balanced/aggressive)
BLOCKLIST_HAGEZI_ULTIMATE=""      # ðŸ“• Ultimate (most aggressive, may break sites)
BLOCKLIST_HAGEZI_NATIVE=""        # Native tracker blocking (can be combined with above)

# Auto-update Schedule
BLOCKLIST_UPDATE_DAY="Sunday"     # Day of week
BLOCKLIST_UPDATE_HOUR="3"         # Hour (24-hour format)

# =============================================================================
# PATHS
# =============================================================================

# Installation Directories
SLIPS_DIR="/opt/StratosphereLinuxIPS"
SURICATA_CONFIG_DIR="/etc/suricata"
IPS_FILTER_DB="/var/lib/suricata/ips_filter.db"

# Log Directory
LOG_DIR="/var/log"
INSTALL_LOG="$LOG_DIR/ips-installer.log"

# =============================================================================
# SERVICES
# =============================================================================

# Service Names
SERVICE_SURICATA="suricata"
SERVICE_SLIPS="slips"
SERVICE_SLIPS_WEBUI="slips-webui"
SERVICE_REDIS="redis-server"

# =============================================================================
# FEATURES
# =============================================================================

# Enable/Disable Features
INSTALL_SLIPS=true                # Install SLIPS
INSTALL_ML_DETECTOR=true          # Install ML Detector Dashboard
INSTALL_BLOCKLISTS=true           # Install community blocklists
INSTALL_NODEJS=true               # Install Node.js (for Kalipso)
INSTALL_WEBUI=true                # Install SLIPS Web UI

# =============================================================================
# NGINX REVERSE PROXY CONFIGURATION
# =============================================================================

# Enable Nginx reverse proxy with HTTPS and authentication
ENABLE_NGINX=true                 # Enable Nginx reverse proxy
NGINX_HTTPS=true                  # Enable HTTPS/TLS
NGINX_AUTH=true                   # Enable HTTP Basic Authentication
NGINX_PORT=443                    # HTTPS port (default: 443)
NGINX_HTTP_PORT=80                # HTTP port for redirect (default: 80)

# Authentication Credentials
# Leave empty for random password generation
NGINX_USERNAME="admin"            # Username for web interface
NGINX_PASSWORD=""                 # Password (leave empty to auto-generate)

# Web Interface Backend
WEBUI_IP="127.0.0.1"              # SLIPS web interface IP
WEBUI_PORT=55000                  # SLIPS web interface port

# =============================================================================
# ADVANCED
# =============================================================================

# Kernel Tuning
ENABLE_KERNEL_TUNING=true         # Apply kernel performance tuning

# Debug Mode
DEBUG=0                           # Set to 1 for verbose output

# Non-interactive Mode
NON_INTERACTIVE=0                 # Set to 1 to skip prompts

# Package Manager
export DEBIAN_FRONTEND=noninteractive
export TZ=UTC
