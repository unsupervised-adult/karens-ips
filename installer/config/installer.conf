# Karen's IPS Installer Configuration
# SPDX-FileCopyrightText: 2025 Karen's IPS
# SPDX-License-Identifier: GPL-2.0-only

# =============================================================================
# NETWORK CONFIGURATION
# =============================================================================

# Management Interface (SSH access, updates)
MGMT_IFACE="enp6s18"
MGMT_IP="dhcp"                    # Or specific IP like "10.10.254.10/24"
MGMT_GW=""                        # Gateway (if static IP)
MGMT_DNS="10.10.254.189"          # DNS server

# Bridge Interfaces (traffic inspection)
IFACE_IN="enp6s19"                # Bridge input interface
IFACE_OUT="enp6s20"               # Bridge output interface

# Network Definition
HOME_NET="10.10.254.0/24"         # Protected network CIDR

# =============================================================================
# SYSTEM CONFIGURATION
# =============================================================================

# Timezone
TIMEZONE="UTC"

# System Requirements
MIN_MEMORY_MB=2048                # Minimum RAM in MB
MIN_CPU_CORES=2                   # Minimum CPU cores

# =============================================================================
# SURICATA CONFIGURATION
# =============================================================================

# Suricata Version
SURICATA_VERSION="8.0"

# Suricata Performance
SURICATA_AF_PACKET_THREADS=4      # AF_PACKET threads
SURICATA_WORKERS=4                # Worker threads

# NFQUEUE Configuration
NFQUEUE_ID=0                      # NFQUEUE queue ID
NFQUEUE_SIZE=4096                 # Queue size

# Rule Sources
SURICATA_ENABLE_ET_OPEN=true      # Emerging Threats Open
SURICATA_ENABLE_ET_PRO=false      # Emerging Threats Pro (requires license)

# =============================================================================
# SLIPS CONFIGURATION
# =============================================================================

# SLIPS Branch
SLIPS_BRANCH="develop"            # Git branch to use

# SLIPS Web UI
SLIPS_WEBUI_PORT=55000            # Web interface port

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis Database IDs
REDIS_DB_SLIPS=1                  # SLIPS database
REDIS_DB_ML_DETECTOR=2            # ML Detector database

# Redis Performance
REDIS_MAX_MEMORY="2gb"            # Maximum memory
REDIS_MAX_MEMORY_POLICY="allkeys-lru"

# =============================================================================
# BLOCKLIST CONFIGURATION
# =============================================================================

# Blocklist Repositories
BLOCKLISTS_DIR="/opt/karens-ips-blocklists"

# Auto-update Schedule
BLOCKLIST_UPDATE_DAY="Sunday"     # Day of week
BLOCKLIST_UPDATE_HOUR="3"         # Hour (24-hour format)

# =============================================================================
# PATHS
# =============================================================================

# Installation Directories
SLIPS_DIR="/opt/StratosphereLinuxIPS"
SURICATA_CONFIG_DIR="/etc/suricata"
IPS_FILTER_DB="/var/lib/suricata/ips_filter.db"

# Log Directory
LOG_DIR="/var/log"
INSTALL_LOG="$LOG_DIR/ips-installer.log"

# =============================================================================
# SERVICES
# =============================================================================

# Service Names
SERVICE_SURICATA="suricata"
SERVICE_SLIPS="slips"
SERVICE_SLIPS_WEBUI="slips-webui"
SERVICE_REDIS="redis-server"

# =============================================================================
# FEATURES
# =============================================================================

# Enable/Disable Features
INSTALL_SLIPS=true                # Install SLIPS
INSTALL_ML_DETECTOR=true          # Install ML Detector Dashboard
INSTALL_BLOCKLISTS=true           # Install community blocklists
INSTALL_NODEJS=true               # Install Node.js (for Kalipso)
INSTALL_WEBUI=true                # Install SLIPS Web UI

# =============================================================================
# ADVANCED
# =============================================================================

# Kernel Tuning
ENABLE_KERNEL_TUNING=true         # Apply kernel performance tuning

# Debug Mode
DEBUG=0                           # Set to 1 for verbose output

# Non-interactive Mode
NON_INTERACTIVE=0                 # Set to 1 to skip prompts

# Package Manager
export DEBIAN_FRONTEND=noninteractive
export TZ=UTC
